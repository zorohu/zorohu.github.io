<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="hexo"><meta name="keyword" content=""><link rel="shortcut icon" href="/img/favicon.ico"><title>git-use - AuthorZero的博客 | AuthorZero&#39;s Blog</title><link rel="canonical" href="https://authorzero.com/2023/04/08/git-use/"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/hux-blog.min.css"><link rel="stylesheet" href="/css/highlight.css"><link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><script></script><meta name="generator" content="Hexo 6.3.0"></head><body ontouchstart=""><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class="container-fluid"><div class="navbar-header page-scroll"><button type="button" class="navbar-toggle"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/">AuthorZero的博客</a></div><div id="huxblog_navbar"><div class="navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/archives/">Archives</a></li><li><a href="/tags/">Tags</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");function handleMagic(e){0<$navbar.className.indexOf("in")?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}$toggle.addEventListener("click",handleMagic)</script><style type="text/css">header.intro-header{background-image:url(post-bg-2023.jpg)}</style><header class="intro-header"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><div class="tags"><a class="tag" href="/tags/#技术" title="技术">技术</a> <a class="tag" href="/tags/#工具" title="工具">工具</a></div><h1>git-use</h1><h2 class="subheading">&#34;git的常用使用技巧&#34;</h2><span class="meta">Posted by author.zero on 2023-04-08</span></div></div></div></div></header><article><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container"><blockquote><p>“Never complain, never explain. Resist the temptation to defend yourself or make excuses. ”</p></blockquote><h1 id="git的常用使用技巧"><a href="#git的常用使用技巧" class="headerlink" title="git的常用使用技巧"></a>git的常用使用技巧</h1><h2 id="includeIf"><a href="#includeIf" class="headerlink" title="includeIf"></a>includeIf</h2><p>在一些时候，我们希望 git 有不同的配置。比如在公司的项目中你使用的 <code>user.name</code> 是 <code>王思葱</code>，<code>user.email</code> 是 <code>wsc@abc.com</code>。在开源项目或者自己的项目中使用的<code>user.name</code> 是 <code>沸羊羊</code>、 <code>user.email</code> 是 <code>fyy@def.com</code>。</p><p>可能大家一般配置的时候是这样<br><code>git config user.name &quot;王思葱&quot;</code><br>或者这样<br><code>git config --global user.name &quot;沸羊羊&quot;</code></p><blockquote><p>在这里首先说一下<code>git config</code>支持系统层级 <code>--system</code>、 用户层级 <code>--global</code> 与仓库层级（无选项）的配置<code>git config</code>。</p></blockquote><p>但是, 手动地通过 <code>git config</code> 指定未免过于繁琐。 本文介绍了一种通过修改 git 的全局配置文件 <code>.gitconfig</code>，使用 <a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-config#_conditional_includes"><code>[includeIf]</code></a> 对<strong>某个文件夹</strong>下的所有 git 项目指定 git 配置的方法。</p><p>从 git 2.13.0 开始，git 配置文件开始支持 <a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-config#_conditional_includes">Conditional Includes</a> 的配置。通过设置 <code>includeIf.&lt;condition&gt;.path</code>，可以向命中 <code>condition</code> 的 git 仓库引入 <code>path</code> 指向的一个 git 配置文件中配置。</p><p><code>[includeIf]</code> 的语法如下，<code>&lt;keyword&gt;</code> 为关键词，<code>&lt;data&gt;</code> 是与关键词关联的数据， 具体意义由关键词决定。</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[includeIf &quot;&lt;keyword&gt;:&lt;data&gt;&quot;]</span><br><span class="line"><span class="type">path</span> = <span class="type">path</span>/<span class="keyword">to</span>/gitconfig</span><br></pre></td></tr></table></figure><p>其中支持的 keyword 有：</p><ul><li><code>gitdir</code>: 其中 <code>&lt;data&gt;</code> 是一个 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Glob_(programming)">glob pattern</a> 如果代码仓库的<code>.git</code>目录匹配 <code>&lt;data&gt;</code> 指定的 glob pattern，那么条件命中；</li><li><code>gitdir/i</code>：<code>gitdir</code>的大小写不敏感版本。</li><li><code>onbranch</code>：其中 <code>&lt;data&gt;</code> 是匹配分支名的一个glob pattern。 假如代码仓库中分支名匹配 <code>&lt;data&gt;</code>，那么条件命中。</li></ul><p>就我们的需求，使用 <code>gitdir</code> 完全可以。</p><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>假设在家用工作电脑上，我们默认开发的是个人项目。有时为了应对紧急需求， 会将公司项目 clone 到电脑中，统一放置放到 <code>~/corp-projects/</code> 目录下面。 个人项目与公司项目的差异点在：第一、使用的邮箱名不同， 个人项目会使用个人邮箱，公司项目使用公司邮箱；第二， 公司项目可能需要 VPN 接入才能够存取代码库。 我们首选使用，用户层级的 git 配置文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.gitconfig</span><br></pre></td></tr></table></figure><p>在最后添加一个 conditional include:</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ~<span class="regexp">/corp-projects/</span> 下面的所有仓库引入 `~<span class="regexp">/crop-projects/</span>.gitconfig` 中的配置</span><br><span class="line">[includeIf <span class="string">&quot;gitdir:~/corp-projects/&quot;</span>]</span><br><span class="line">  path = ~<span class="regexp">/corp-projects/</span>.gitconfig</span><br></pre></td></tr></table></figure><p>最后创建公司项目统一的配置文件：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~<span class="regexp">/corp-projects/</span>.gitconfig</span><br></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[user]</span></span><br><span class="line">  <span class="attr">name</span> = &lt;Your Name&gt;</span><br><span class="line">  <span class="attr">email</span> = &lt;Your Email&gt;</span><br><span class="line"></span><br><span class="line"><span class="section">[http]</span></span><br><span class="line">  <span class="comment"># 代理地址，如果公司项目需要代理才能够存取，填写此项；如果不需要，则不用这一行</span></span><br><span class="line">  <span class="attr">proxy</span> = &lt;Proxy URL&gt;</span><br></pre></td></tr></table></figure><h2 id="cherry-pick"><a href="#cherry-pick" class="headerlink" title="cherry-pick"></a>cherry-pick</h2><p>chary-pick直译为樱桃🍒采摘，所以其实它的作用和采摘有很大的关系。当你需要合并A分支中的某些commit而不是直接合并A分支，这时候你只需要采摘A分支中的某几个commit合并进去</p><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><p><code>git cherry-pick</code>命令的作用，就是将指定的提交（commit）应用于其他分支。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ git cherry-pick &lt;commitHash&gt;</span><br></pre></td></tr></table></figure></blockquote><p>上面命令就会将指定的提交<code>commitHash</code>，应用于当前分支。这会在当前分支产生一个新的提交，当然它们的哈希值会不一样。</p><p>举例来说，代码仓库有<code>master</code>和<code>feature</code>两个分支。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a - b - c - d   Master</span><br><span class="line">     \</span><br><span class="line">       e - f - g Feature</span><br></pre></td></tr></table></figure></blockquote><p>现在将提交<code>f</code>应用到<code>master</code>分支。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 切换到 master 分支</span></span><br><span class="line">$ git checkout master</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cherry pick 操作</span></span><br><span class="line">$ git cherry-pick f</span><br></pre></td></tr></table></figure></blockquote><p>上面的操作完成以后，代码库就变成了下面的样子。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a - b - c - d - f   Master</span><br><span class="line">     \</span><br><span class="line">       e - f - g Feature</span><br></pre></td></tr></table></figure></blockquote><p>从上面可以看到，<code>master</code>分支的末尾增加了一个提交<code>f</code>。</p><p><code>git cherry-pick</code>命令的参数，不一定是提交的哈希值，分支名也是可以的，表示转移该分支的最新提交。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ git cherry-pick feature</span><br></pre></td></tr></table></figure></blockquote><p>上面代码表示将<code>feature</code>分支的最近一次提交，转移到当前分支。</p><h3 id="转移多个提交"><a href="#转移多个提交" class="headerlink" title="转移多个提交"></a>转移多个提交</h3><p>Cherry pick 支持一次转移多个提交。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ git cherry-pick &lt;HashA&gt; &lt;HashB&gt;</span><br></pre></td></tr></table></figure></blockquote><p>上面的命令将 A 和 B 两个提交应用到当前分支。这会在当前分支生成两个对应的新提交。</p><p>如果想要转移一系列的连续提交，可以使用下面的简便语法。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ git cherry-pick A..B </span><br></pre></td></tr></table></figure></blockquote><p>上面的命令可以转移从 A 到 B 的所有提交。它们必须按照正确的顺序放置：提交 A 必须早于提交 B，否则命令将失败，但不会报错。</p><p>注意，使用上面的命令，提交 A 将不会包含在 Cherry pick 中。如果要包含提交 A，可以使用下面的语法。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ git cherry-pick A^..B </span><br></pre></td></tr></table></figure></blockquote><h2 id="git-stash"><a href="#git-stash" class="headerlink" title="git-stash"></a>git-stash</h2><p>发现有一个类是多余的，想删掉它又担心以后需要查看它的代码，想保存它但又不想增加一个脏的提交。这时就可以考虑git stash。<br>使用git的时候，我们往往使用分支（branch）解决任务切换问题，例如，我们往往会建一个自己的分支去修改和调试代码, 如果别人或者自己发现原有的分支上有个不得不修改的bug，我们往往会把完成一半的代码commit提交到本地仓库，然后切换分支去修改bug，改好之后再切换回来。这样的话往往log上会有大量不必要的记录。其实如果我们不想提交完成一半或者不完善的代码，但是却不得不去修改一个紧急Bug，那么使用git stash就可以将你当前未提交到本地（和服务器）的代码推入到Git的栈中，这时候你的工作区间和上一次提交的内容是完全一样的，所以你可以放心的修Bug，等到修完Bug，提交到服务器上后，再使用git stash apply将以前一半的工作应用回来。</p><h3 id="stash当前修改"><a href="#stash当前修改" class="headerlink" title="stash当前修改"></a>stash当前修改</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git stash</span><br><span class="line">Saved working directory <span class="keyword">and</span> index state WIP <span class="keyword">on</span> master: <span class="number">5002</span>d47 our <span class="keyword">new</span> homepage</span><br><span class="line">HEAD <span class="keyword">is</span> now at <span class="number">5002</span>d47 our <span class="keyword">new</span> homepage</span><br></pre></td></tr></table></figure><p>实际应用中推荐给每个stash加一个message，用于记录版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git stash save <span class="string">&quot;test-cmd-stash&quot;</span></span><br><span class="line">Saved working directory and index state On autoswitch: test-cmd-stash</span><br><span class="line">HEAD 现在位于 296e8d4 remove unnecessary postion reset <span class="keyword">in</span> onResume <span class="keyword">function</span></span><br><span class="line">$ git stash list</span><br><span class="line">stash@&#123;0&#125;: On autoswitch: test-cmd-stash</span><br></pre></td></tr></table></figure><h3 id="重新应用缓存的stash"><a href="#重新应用缓存的stash" class="headerlink" title="重新应用缓存的stash"></a>重新应用缓存的stash</h3><h5 id="1、将缓存堆栈中的第一个stash删除，并将对应修改应用到当前的工作目录下"><a href="#1、将缓存堆栈中的第一个stash删除，并将对应修改应用到当前的工作目录下" class="headerlink" title="1、将缓存堆栈中的第一个stash删除，并将对应修改应用到当前的工作目录下"></a>1、将缓存堆栈中的第一个stash删除，并将对应修改应用到当前的工作目录下</h5><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>git stash pop</span><br></pre></td></tr></table></figure><h5 id="2、可以使用git-stash-apply命令，将缓存堆栈中的stash多次应用到工作目录中，但并不删除stash拷贝"><a href="#2、可以使用git-stash-apply命令，将缓存堆栈中的stash多次应用到工作目录中，但并不删除stash拷贝" class="headerlink" title="2、可以使用git stash apply命令，将缓存堆栈中的stash多次应用到工作目录中，但并不删除stash拷贝"></a>2、可以使用git stash apply命令，将缓存堆栈中的stash多次应用到工作目录中，但并不删除stash拷贝</h5><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>git stash apply</span><br></pre></td></tr></table></figure><p><em>可以使用名字指定使用哪个stash，默认使用最近的stash（即stash@{0}）</em></p><h5 id="3、-查看现有stash"><a href="#3、-查看现有stash" class="headerlink" title="3、 查看现有stash"></a>3、 查看现有stash</h5><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git stash list</span><br><span class="line">stash@&#123;<span class="number">0</span>&#125;: WIP <span class="keyword">on</span> master: <span class="number">049</span>d078 added the index file</span><br><span class="line">stash@&#123;<span class="number">1</span>&#125;: WIP <span class="keyword">on</span> master: c264051 Revert <span class="string">&quot;added file_size&quot;</span></span><br><span class="line">stash@&#123;<span class="number">2</span>&#125;: WIP <span class="keyword">on</span> master: <span class="number">21</span>d80a5 added number to log</span><br></pre></td></tr></table></figure><h5 id="4、-移除stash"><a href="#4、-移除stash" class="headerlink" title="4、 移除stash"></a>4、 移除stash</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git stash list</span><br><span class="line"><span class="symbol">stash@</span>&#123;<span class="number">0</span>&#125;: WIP on master: 049d078 added the index file</span><br><span class="line"><span class="symbol">stash@</span>&#123;<span class="number">1</span>&#125;: WIP on master: c264051 Revert <span class="string">&quot;added file_size&quot;</span></span><br><span class="line"><span class="symbol">stash@</span>&#123;<span class="number">2</span>&#125;: WIP on master: 21d80a5 added number to log</span><br><span class="line">$ git stash drop <span class="symbol">stash@</span>&#123;<span class="number">0</span>&#125;</span><br><span class="line">Dropped <span class="symbol">stash@</span>&#123;<span class="number">0</span>&#125; (364e91f3f268f0900bc3ee613f9f733e82aaed43)</span><br></pre></td></tr></table></figure><h5 id="5、-查看指定stash的diff"><a href="#5、-查看指定stash的diff" class="headerlink" title="5、 查看指定stash的diff"></a>5、 查看指定stash的diff</h5><p>可以使用git stash show命令，后面可以跟着stash名字。示例如下：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ git stash <span class="keyword">show</span></span><br><span class="line"> index.html | <span class="number">1</span> +</span><br><span class="line"> style.css | <span class="number">3</span> +++</span><br><span class="line"> <span class="number">2</span> files changed, <span class="number">4</span> insertions(+)</span><br><span class="line">在该命令后面添加-p或--patch可以查看特定stash的全部diff，如下：</span><br><span class="line"></span><br><span class="line">$ git stash <span class="keyword">show</span> -p</span><br><span class="line">diff --git a/style.css b/style.css</span><br><span class="line"><span class="keyword">new</span> file mode <span class="number">100644</span></span><br><span class="line">index <span class="number">0000000.</span>.d92368b</span><br><span class="line">--- /dev/<span class="keyword">null</span></span><br><span class="line">+++ b/style.css</span><br><span class="line">@@ <span class="number">-0</span>,<span class="number">0</span> +<span class="number">1</span>,<span class="number">3</span> @@</span><br><span class="line">+* &#123;</span><br><span class="line">+  text-decoration: blink;</span><br><span class="line">+&#125;</span><br><span class="line">diff --git a/index.html b/index.html</span><br><span class="line">index <span class="number">9</span>daeafb..ebdcbd2 <span class="number">100644</span></span><br><span class="line">--- a/index.html</span><br><span class="line">+++ b/index.html</span><br><span class="line">@@ <span class="number">-1</span> +<span class="number">1</span>,<span class="number">2</span> @@</span><br><span class="line">+&lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;style.css&quot;</span>/&gt;</span><br></pre></td></tr></table></figure><h5 id="6、-从stash创建分支"><a href="#6、-从stash创建分支" class="headerlink" title="6、 从stash创建分支"></a>6、 从stash创建分支</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ git stash branch testchanges</span><br><span class="line">Switched to a new branch <span class="string">&quot;testchanges&quot;</span></span><br><span class="line"># On branch testchanges</span><br><span class="line"># Changes to be committed:</span><br><span class="line">#   (use <span class="string">&quot;git reset HEAD &lt;file&gt;...&quot;</span> to unstage)</span><br><span class="line">#</span><br><span class="line"><span class="meta">#      modified:   index.html</span></span><br><span class="line">#</span><br><span class="line"># Changes not staged <span class="keyword">for</span> commit:</span><br><span class="line">#   (use <span class="string">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed)</span><br><span class="line">#</span><br><span class="line"><span class="meta">#      modified:   lib/simplegit.rb</span></span><br><span class="line">#</span><br><span class="line">Dropped refs/stash@&#123;<span class="number">0</span>&#125; (f0dfc4d5dc332d1cee34a634182e168c4efc3359)</span><br></pre></td></tr></table></figure><p>该命令会用stash中的修改创建一个新的分支，创建成功后会删除此stash</p><h2 id="git-rebase"><a href="#git-rebase" class="headerlink" title="git rebase"></a>git rebase</h2><p>在合并代码的时候很多时候我们都是使用 <code>git merge</code> , 但是merge在 合并代码的时候会产生一个新的commit节点，表示这里合并过代码。所以 在一些情况下如果你只是想合并上游的分支代码，而不想产生一个毫无意义的commit节点。这时候就可以采用<code>git rebase</code> 让你提取上游分支的改动来合并到你的分支中，而不会产生额外的节点</p><p>如果上游分支已经包含您所做的更改（例如，因为您邮寄了上游应用的补丁），则该提交将被跳过并发出警告（如果使用合并后端）。例如，在以下历史记录上运行 <code>git rebase master</code> （其中 <code>A&#39;</code> 和 <code>A</code> 引入相同的更改集，但具有不同的提交者信息）：</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">      <span class="comment">A</span><span class="literal">---</span><span class="comment">B</span><span class="literal">---</span><span class="comment">C topic</span></span><br><span class="line">     <span class="comment">/</span></span><br><span class="line"><span class="comment">D</span><span class="literal">---</span><span class="comment">E</span><span class="literal">---</span><span class="comment">A&#x27;</span><span class="literal">---</span><span class="comment">F master</span></span><br></pre></td></tr></table></figure><p>将导致：</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">               <span class="comment">B&#x27;</span><span class="literal">---</span><span class="comment">C&#x27; topic</span></span><br><span class="line">              <span class="comment">/</span></span><br><span class="line"><span class="comment">D</span><span class="literal">---</span><span class="comment">E</span><span class="literal">---</span><span class="comment">A&#x27;</span><span class="literal">---</span><span class="comment">F master</span></span><br></pre></td></tr></table></figure><p>以下是如何将基于一个分支的主题分支移植到另一个分支，以假装您使用 <code>rebase --onto</code> 从后一个分支分叉主题分支。<br>首先，我们假设您的主题基于下一个分支。例如，主题中开发的功能取决于下一个中找到的某些功能。</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o  master</span></span><br><span class="line">         <span class="comment">\</span></span><br><span class="line">          <span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o  next</span></span><br><span class="line">                           <span class="comment">\</span></span><br><span class="line">                            <span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o  topic</span></span><br><span class="line"><span class="comment">我们想让主题从分支主分支中分叉出来；例如，因为 topic 所依赖的功能被合并到更稳定的 master 分支中。我们希望我们的树看起来像这样：</span></span><br></pre></td></tr></table></figure><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o  master</span></span><br><span class="line">        <span class="comment">|            \</span></span><br><span class="line">        <span class="comment">|             o&#x27;</span><span class="literal">--</span><span class="comment">o&#x27;</span><span class="literal">--</span><span class="comment">o&#x27;  topic</span></span><br><span class="line">         <span class="comment">\</span></span><br><span class="line">          <span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o</span><span class="literal">---</span><span class="comment">o  next</span></span><br><span class="line"><span class="comment">我们可以使用以下命令来获取它：</span></span><br></pre></td></tr></table></figure><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase --onto <span class="keyword">master</span> <span class="title">next</span> topic</span><br></pre></td></tr></table></figure><p>–onto 选项的另一个示例是对分支的一部分进行变基。如果我们有以下情况：</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                        <span class="comment">H</span><span class="literal">---</span><span class="comment">I</span><span class="literal">---</span><span class="comment">J topicB</span></span><br><span class="line">                       <span class="comment">/</span></span><br><span class="line">              <span class="comment">E</span><span class="literal">---</span><span class="comment">F</span><span class="literal">---</span><span class="comment">G  topicA</span></span><br><span class="line">             <span class="comment">/</span></span><br><span class="line"><span class="comment">A</span><span class="literal">---</span><span class="comment">B</span><span class="literal">---</span><span class="comment">C</span><span class="literal">---</span><span class="comment">D  master</span></span><br></pre></td></tr></table></figure><p>然后命令</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase --onto <span class="keyword">master</span> <span class="title">topicA</span> topicB</span><br></pre></td></tr></table></figure><p>会导致：</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">             <span class="comment">H&#x27;</span><span class="literal">--</span><span class="comment">I&#x27;</span><span class="literal">--</span><span class="comment">J&#x27;  topicB</span></span><br><span class="line">            <span class="comment">/</span></span><br><span class="line">            <span class="comment">| E</span><span class="literal">---</span><span class="comment">F</span><span class="literal">---</span><span class="comment">G  topicA</span></span><br><span class="line">            <span class="comment">|/</span></span><br><span class="line"><span class="comment">A</span><span class="literal">---</span><span class="comment">B</span><span class="literal">---</span><span class="comment">C</span><span class="literal">---</span><span class="comment">D  master</span></span><br></pre></td></tr></table></figure><p>当 topicB 不依赖于 topicA 时，这很有用。</p><p>一系列提交也可以通过变基来删除。如果我们有以下情况：</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">E</span><span class="literal">---</span><span class="comment">F</span><span class="literal">---</span><span class="comment">G</span><span class="literal">---</span><span class="comment">H</span><span class="literal">---</span><span class="comment">I</span><span class="literal">---</span><span class="comment">J  topicA</span></span><br></pre></td></tr></table></figure><p>然后命令</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">git</span> rebase --onto topicA~<span class="number">5</span> topicA~<span class="number">3</span> topicA</span><br></pre></td></tr></table></figure><p>将导致删除提交 F 和 G：</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">E</span><span class="literal">---</span><span class="comment">H&#x27;</span><span class="literal">---</span><span class="comment">I&#x27;</span><span class="literal">---</span><span class="comment">J&#x27;  topicA</span></span><br></pre></td></tr></table></figure><p>如果 F 和 G 在某些方面有缺陷，或者不应该成为 topicA 的一部分，那么这很有用。请注意， <code>--onto</code> 的参数和 <code>&lt;upstream&gt;</code> 参数可以是任何有效的提交。</p><p>如果发生冲突， <code>git rebase</code> 将在第一个有问题的提交处停止，并在树中留下冲突标记。您可以使用 <code>git diff</code> 定位标记 (&lt;&lt;&lt;&lt;&lt;&lt;) 并进行编辑以解决冲突。对于您编辑的每个文件，您需要告诉 Git 冲突已解决，通常可以使用</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">add</span> &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>手动解决冲突并使用所需的解决方案更新索引后，您可以继续执行变基过程</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase --<span class="keyword">continue</span></span><br></pre></td></tr></table></figure><p>或者，您可以使用以下命令撤消 git rebase</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase <span class="comment">--abort</span></span><br></pre></td></tr></table></figure><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul><li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/1c7ecc8d3dfb">https://www.jianshu.com/p/1c7ecc8d3dfb</a></li><li><a target="_blank" rel="noopener" href="https://ayase.moe/2021/03/09/customized-git-config/">https://ayase.moe/2021/03/09/customized-git-config/</a></li><li><a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-rebase">https://git-scm.com/docs/git-rebase</a></li></ul><hr><ul class="pager"><li class="previous"><a href="/2023/05/27/mysql-master-slave/" data-toggle="tooltip" data-placement="top" title="mysql-master-slave">&larr; Previous Post</a></li><li class="next"><a href="/2023/03/05/tools-proxy/" data-toggle="tooltip" data-placement="top" title="whistle web开发调试神器">Next Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0 visible-lg-block sidebar-container catalog-container"><div class="side-catalog"><hr class="hidden-sm hidden-xs"><h5><a class="catalog-toggle" href="#">CATALOG</a></h5><ul class="catalog-body"></ul></div></div><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 sidebar-container"><section><h5><a href="/tags/">FEATURED TAGS</a></h5><div class="tags"><a class="tag" href="/tags/#技术" title="技术">技术</a> <a class="tag" href="/tags/#工具" title="工具">工具</a></div></section><hr><h5>FRIENDS</h5><ul class="list-inline"><li><a href="http://blog.kaijun.rocks" target="_blank">Kaijun&#39;s Blog</a></li><li><a href="http://huangxuan.me" target="_blank">Hux Blog</a></li><li><a href="#" target="_blank">Foo</a></li><li><a href="#" target="_blank">Bar</a></li><li><a href="#" target="_blank">Example Friends</a></li><li><a href="#" target="_blank">It helps SEO</a></li></ul></div></div></div></article><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",function(e){n(null,e)},!1),c.parentNode.insertBefore(r,c)}</script><script>async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){anchors.options={visible:"always",placement:"right",icon:"#"},anchors.add().remove(".intro-header h1").remove(".subheading").remove(".sidebar-container h5")})</script><style>@media all and (min-width:800px){.anchorjs-link{position:absolute;left:-.75em;font-size:1.1em;margin-top:-.1em}}</style><footer><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a target="_blank" href="https://twitter.com/author22282473"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" href="https://www.zhihu.com/people/auth0"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">知</i></span></a></li><li><a target="_blank" href="https://weibo.com/ZoroP"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-weibo fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" href="https://www.facebook.com/author.zero"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" href="https://github.com/zorohu"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" href="https://www.linkedin.com/in/author.zero"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; AuthorZero的博客 2018 - 2023 <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">鄂ICP备20003318号</a><br>Theme by <a target="_blank" rel="noopener" href="https://huangxuan.me">Hux</a> <span style="display:inline-block;margin:0 5px"><i class="fa fa-heart"></i> </span>Ported by <a target="_blank" rel="noopener" href="https://blog.kaijun.rocks">Kaijun</a> |<iframe style="margin-left:2px;margin-bottom:-5px" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=kaijun&repo=hexo-theme-huxblog&type=star&count=true"></iframe><br><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次 本站访客数<span id="busuanzi_value_site_uv"></span>人次 本文总阅读量<span id="busuanzi_value_page_pv"></span>次</span><br><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date(2018,4,13,19,23,16);now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已安全运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script></p></div></div></div></footer><script src="/js/jquery.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/hux-blog.min.js"></script><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",function(e){n(null,e)},!1),c.parentNode.insertBefore(r,c)}</script><script>0!==$("#tag_cloud").length&&async("https://authorzero.com/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js",function(){var c=document.querySelector("nav");c&&FastClick.attach(c)})</script><script>var _gaId="UA-49627206-1",_gaDomain="huangxuan.me";!function(a,e,n,g,t,c){a.GoogleAnalyticsObject=g,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=+new Date,t=e.createElement(n),c=e.getElementsByTagName(n)[0],t.async=1,t.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(t,c)}(window,document,"script","ga"),ga("create",_gaId,_gaDomain),ga("send","pageview")</script><script>var _baId="4cc1f2d8f3067386cc5cdb626a202900",_hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?"+_baId;var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(e,c)}()</script><script type="text/javascript">function generateCatalog(e){_containerSelector="div.post-container";var a,l,n,t,o,c=$(_containerSelector).find("h1,h2,h3,h4,h5,h6");return $(e).html(""),c.each(function(){a=$(this).prop("tagName").toLowerCase(),t="#"+$(this).prop("id"),l=$(this).text(),o=$('<a href="'+t+'" rel="nofollow">'+l+"</a>"),n=$('<li class="'+a+'_nav"></li>').append(o),$(e).append(n)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),async("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><img src="https://authorzero.com/img/icon_wechat.png" width="0" height="0"></body></html>